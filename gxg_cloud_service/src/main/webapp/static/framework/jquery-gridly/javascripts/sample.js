// Generated by CoffeeScript 1.9.3

function getbrick(){
	  var bid = $("#btn").combobox('getValue');// 获取当前选中的值	
  	if (bid==""||bid==undefined){
  		return false;
  	}
	   var bname = $("#btn").combobox('getText');// 获取当前选中的值	
  	  var brick1 = "<div class='brick small'><a class='delete'>&times;</a><small>"+bid+"</small><b>"+bname+"</b></div>";
 	 $('#edit_row1_dialog').dialog('close');
  	  return brick1;
}

(function() {
  $(function() {
    var brick;
   
    brick = "<div class='brick small'><a class='delete'>&times;</a></div>";
    var blank = "<div class='brick blank'><a class='delete'>&times;</a></div>";
   /* $(document).on("click touchend", ".gridly .brick", function(event) {
      var $this, size;
      event.preventDefault();
      event.stopPropagation();
      $this = $(this);
      $this.toggleClass('small');
      $this.toggleClass('large');
      if ($this.hasClass('small')) {
        size = 140;
      }
      if ($this.hasClass('large')) {
        size = 300;
      }
      $this.data('width', size);
      $this.data('height', size);
      return $('.gridly').gridly('layout');
    });*/
    $(document).on("click", ".gridly .delete", function(event) {
      var $this;
      event.preventDefault();
      event.stopPropagation();
      $this = $(this);
      $this.closest('.brick').remove();
      return $('.gridly').gridly('layout');
    });
    //增加空白子元素
    $(document).on("click", ".addblank", function(event) {
      event.preventDefault();
      event.stopPropagation();
      $('.gridly').append(blank);
      return $('.gridly').gridly();
    });
 
  //增加元素
  $(document).on("click", ".addbtn", function(event) {
	  if(getbrick()==false){
		  return;
	  }
     $('.gridly').append(getbrick());
      return $('.gridly').gridly();
    
  }); 
    
    //增加元素
    $(document).on("click", ".add", function(event) {
    	console.log(btns);
    	$('#btn').combobox({
		 	valueField : 'id',
			textField : 'name',
			data:btns,
			required:true
		})
     	$('#edit_row1_dialog').dialog('open');
    	event.preventDefault();
        event.stopPropagation();
    }); 
    
    
    return $('.gridly').gridly();
  });

}).call(this);
